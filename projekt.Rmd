---
title: "SAP Projekt"
author: "Lovre Jurjević"
date: "2025-12-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(boot)
```

### Motivacija i opis problema

Moždani udar je hitno medicinsko stanje koje nastaje nakon poremećaja cirkulacije u mozgu. U Hrvatskoj je drugi najveći uzrok smrti te prvi najveći uzrok invaliditeta. Rizik od moždanog udara kod pojedine osobe može ovisiti o više faktora pa se u medicini koriste razni modeli za njegovu procjenu. Nije strana ni uporaba alata zasnovanih na umjernoj inteligenciji. Predikcija moždanog udara bitna je za pravovremenu identifikaciju rizika koje omogućava pravovremene mjere prevencije i osvještavanje populacije.

### Opis skupa podataka

Prikupljeni skup podataka sadrži kliničke podatke o pacijentima i informacije o moždanom udaru. Za svakog pacijenta navedena je vrijednost 12 značajki grupiranih u 4 kategorije: demografski podaci, zdravstveni podaci, fiziološki podaci i životne navike. Cilj je uočiti povezanost izmjerenih podataka i rizika od moždanog udara. Skup podataka sadržava 5,110 zapisa o pacijentima od kojih je njih 249 doživjelo moždani udar. Udio pacijenata koji su doživjeli moždani udar iznosi 4.87%

-   id: jedinstveni identifikator pacijenta
-   gender: spol pacijenta (Male, Female)
-   age: dob pacijenta
-   hypertension: oznaka koja daje informaciju o tome ima li pacijent visoki tlak (0, 1)
-   heart_disease: oznaka koja daje informaciju ima li pacijent neku srčanu bolest (0, 1)
-   ever_married: odgovara na pitanje je li pacijent ikad bio u braku (No, Yes) work_type: tip zaposlenja (children, Govt_job, Never_worked, Private, Self-employed)
-   Residence_type: tip prebivališta u kojem živi pacijent (Rural, Urban)
-   avg_glucose_lvl: prosječna razina glukoze u krvi (mg/dL)
-   bmi: indeks tjelesne mase koji predstavlja odnos visine i težine pacijenta
-   smoking_status: opis pacijentovog odnosa s pušenjem cigareta (formerly smoked, never smoked, smokes, Unknown)
-   stroke: oznaka koja daje informaciju je li pacijent doživio moždani udar (0, 1)

### Učitavanje i pregled podataka

```{r}
data <- read.csv("data.csv")
head(data)
```
```{r}
str(data)
```




### Postoji li statistički značajna razlika u prosječnoj razini glukoze između pacijenata sa i bez moždanog udara?

```{r}
data_stroke <- data[data$stroke == 1, ]$avg_glucose_level
data_no_stroke <- data[data$stroke == 0,]$avg_glucose_level
summary(data_stroke)
summary(data_no_stroke)
```

```{r}
hist(data$avg_glucose_level, freq = FALSE)
curve(dnorm(x, mean(data$avg_glucose_level), sd(data$avg_glucose_level)), add = TRUE)

```

```{r}
set.seed(67)

B <- 10000

boot_diff <- numeric(B)

for (i in 1:B) {
  boot_data_stroke <- sample(data_stroke, replace = TRUE)
  boot_data_no_stroke <- sample(data_no_stroke, replace = TRUE)
  boot_diff[i] <- mean(boot_data_stroke) - mean(boot_data_no_stroke)
}

# Observed mean difference
obs_diff <- mean(data_stroke) - mean(data_no_stroke)

# 95% bootstrap confidence interval
ci <- quantile(boot_diff, c(0.025, 0.975))

list(
  observed_mean_difference = obs_diff,
  ci_95 = ci
)

```
